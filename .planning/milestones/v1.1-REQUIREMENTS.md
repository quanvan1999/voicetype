# Requirements: v1.1 Smart Dictation

**Defined:** 2026-01-18
**Core Value:** Noi Viet, dich tieng Anh, tu dong segment khi pause.

## v1.1 Requirements

### Auto-Translate

- [x] **TRANS-01**: User can enable/disable translate mode trong Settings
- [x] **TRANS-02**: Khi translate mode bat, noi tieng Viet -> output text English
- [x] **TRANS-03**: Translation chay offline (Apple Translation framework)
- [x] **TRANS-04**: Whisper native .translate task lam primary path

### Auto-Segment

- [x] **SEG-01**: Toggle mode tu insert text khi detect silence (2s default)
- [x] **SEG-02**: User co the configure silence threshold trong Settings (1-5s)
- [x] **SEG-03**: Visual feedback khi segment duoc detect (truoc khi insert)
- [x] **SEG-04**: SileroVAD neural detection cho accuracy cao hon energy threshold
- [x] **SEG-05**: Buffer audio tiep tuc khi dang transcribe segment truoc
- [x] **SEG-06**: Queue management cho multiple pending segments
- [x] **SEG-07**: Visual indicator hien "processing X segments"

## Technical Notes

### Translation Strategy

1. **Primary**: Whisper `.translate` task (built-in, single inference)
2. **Fallback**: Apple Translation framework (neu Whisper translate khong du quality)
3. **Future option**: TranslateGemma via Ollama (deferred, can them dependency)

### Segment Pipeline

```
[Audio Buffer] -> [VAD] -> [Silence Detected] -> [Queue] -> [Transcribe] -> [Insert]
                   |
            [Continue Buffer]
```

- VAD runs continuously on audio stream
- When silence > threshold, current audio chunk queued for transcription
- Transcription queue processes sequentially (FIFO)
- Visual indicator shows queue depth

### Dependencies

| Feature | Framework | Notes |
|---------|-----------|-------|
| Translation | Apple Translation | macOS 14.4+, requires language pack download |
| VAD | SileroVAD | CoreML converted, ~3MB model |
| Queue | Swift async/await | Built-in concurrency |

## Out of Scope (v1.1)

| Feature | Reason |
|---------|--------|
| TranslateGemma | Requires Ollama dependency, deferred |
| Real-time streaming display | Still too complex, v2 |
| Multi-language translate | English only for v1.1 |
| Parallel transcription | Sequential simpler, parallel v2 |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| TRANS-01 | Phase 5 | Complete |
| TRANS-02 | Phase 5 | Complete |
| TRANS-03 | Phase 5 | Complete |
| TRANS-04 | Phase 5 | Complete |
| SEG-01 | Phase 6 | Complete |
| SEG-02 | Phase 6 | Complete |
| SEG-03 | Phase 6 | Complete |
| SEG-04 | Phase 6 | Complete |
| SEG-05 | Phase 6 | Complete |
| SEG-06 | Phase 6 | Complete |
| SEG-07 | Phase 6 | Complete |

**Coverage:**
- v1.1 requirements: 11 total
- Translate: 4 (all mapped to Phase 5)
- Segment: 7 (all mapped to Phase 6)
- Mapped: 11/11 (100%)

---
*Created: 2026-01-18*
*Updated: 2026-01-18 - Traceability section populated*
